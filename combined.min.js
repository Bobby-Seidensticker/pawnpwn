namespace.lookup("com.pageforest.aboutpawnpwn").defineOnce(function(b){function n(){window.innerWidth>700?$("body").addClass("wide"):$("body").removeClass("wide")}b.extend({onReady:function(){var b;location.hash?(b='<p>To start playing, send them an <a href="mailto:?subject=Let\'s%20Play%20Pawn%20Pwn&body=http://pawnpwn.pageforest.com/%23undefined">email</a>.  Or get them this link another way:</p>',$("#linkh").attr("href",location.origin+"/"+location.hash),$("#linkh").html(location.origin+"/"+location.hash)):
(b="<p>After you log in and create a game, this sentence will be a handy mailto link as well as the address itself, in case you're in fullscreen mode.  This is what the link to your game will look like: </p>",$("#linkh").attr("href",location.origin+"#yourusername-1234/"));$("#linkp").html(b);$(window).bind("resize",function(){setTimeout(function(){n()},0)});n()}})});namespace.lookup("com.pageforest.graph").defineOnce(function(b){function n(e){this.canvas=e;this.ctx=e.getContext("2d");this.size=k.getSize(e);this.numPoints=20;this.pointMultiple=this.maxHeight=10;this.heightMultiple=5;this.margin=[0,0];this.colors=["#FFF","#000"];this.axisColor="#9e9e9e";this.lineWidth=3;this.lineCap=this.lineJoin="round"}var k=namespace.lookup("org.startpad.dom"),h=namespace.lookup("org.startpad.vector");n.methods({calcScale:function(e){var b,h;for(b=0;b<e.length;b++){var k=e[b];
if(k.length>this.numPoints)this.numPoints=this.roundMult(k.length,this.pointMultiple);for(h=0;h<k.length;h++)if(k[h][1]+2>this.maxHeight)this.maxHeight=k[h][1]+2;this.maxHeight=this.roundMult(this.maxHeight,this.heightMultiple)}this.scale=[this.size[0]/this.numPoints,this.size[1]/this.maxHeight]},ptScaled:function(e){e=h.mult(this.scale,e);h.addTo(e,this.margin);e[1]=this.size[1]-e[1];return e},moveTo:function(e){e=this.ptScaled(e);this.ctx.moveTo(e[0],e[1])},lineTo:function(e){e=this.ptScaled(e);
this.ctx.lineTo(e[0],e[1])},draw:function(e,b,h,k,m){if(b)this.calcScale(e),this.ctx.clearRect(0,0,this.size[0],this.size[1]);else{this.ctx.lineWidth=this.lineWidth;this.ctx.lineJoin=this.lineJoin;this.ctx.lineCap=this.lineCap;if(m)this.ctx.lineWidth=m;if(k)this.ctx.lineCap=k;for(b=0;b<e.length;b++){m=e[b];this.ctx.beginPath();this.moveTo(m[0]);for(k=1;k<m.length;k++)this.lineTo(m[k]);this.ctx.strokeStyle=h?h[b]:this.colors[b];this.ctx.stroke()}this.ctx.fillStyle=this.axisColor;this.ctx.fillRect(0,
0,2,this.canvas.height);this.ctx.fillRect(0,this.canvas.height-2,this.canvas.width,2)}},roundMult:function(e,b){return Math.ceil(e/b)*b}});b.extend({GraphLines:n})});(function(){function b(a,c){var d;this.element=typeof a=="object"?a:document.getElementById(a);this.wrapper=this.element.parentNode;this.element.style.webkitTransitionProperty="-webkit-transform";this.element.style.webkitTransitionTimingFunction="cubic-bezier(0,0,0.25,1)";this.element.style.webkitTransitionDuration="0";this.element.style.webkitTransform=m+"0,0"+t;this.options={bounce:k,momentum:k,checkDOMChanges:!0,topOnDOMChanges:!1,hScrollbar:k,vScrollbar:k,fadeScrollbar:h||!e,shrinkScrollbar:h||
!e,desktopCompatibility:!1,overflow:"auto",snap:!1,bounceLock:!1,scrollbarColor:"rgba(0,0,0,0.5)",onScrollEnd:function(){}};if(typeof c=="object")for(d in c)this.options[d]=c[d];if(this.options.desktopCompatibility)this.options.overflow="hidden";this.onScrollEnd=this.options.onScrollEnd;delete this.options.onScrollEnd;this.wrapper.style.overflow=this.options.overflow;this.refresh();window.addEventListener("onorientationchange"in window?"orientationchange":"resize",this,!1);if(e||this.options.desktopCompatibility)this.element.addEventListener(D,
this,!1),this.element.addEventListener(r,this,!1),this.element.addEventListener(w,this,!1);this.options.checkDOMChanges&&this.element.addEventListener("DOMSubtreeModified",this,!1)}function n(a,c,S,f,e){var b=document;this.dir=a;this.fade=S;this.shrink=f;this.uid=++d;this.bar=b.createElement("div");this.bar.style.cssText="position:absolute;top:0;left:0;-webkit-transition-timing-function:cubic-bezier(0,0,0.25,1);pointer-events:none;-webkit-transition-duration:0;-webkit-transition-delay:0;-webkit-transition-property:-webkit-transform;z-index:10;background:"+
e+";-webkit-transform:"+m+"0,0"+t+";"+(a=="horizontal"?"-webkit-border-radius:3px 2px;min-width:6px;min-height:5px":"-webkit-border-radius:2px 3px;min-width:5px;min-height:6px");this.wrapper=b.createElement("div");this.wrapper.style.cssText="-webkit-mask:-webkit-canvas(scrollbar"+this.uid+this.dir+");position:absolute;z-index:10;pointer-events:none;overflow:hidden;opacity:0;-webkit-transition-duration:"+(S?"300ms":"0")+";-webkit-transition-delay:0;-webkit-transition-property:opacity;"+(this.dir==
"horizontal"?"bottom:2px;left:2px;right:7px;height:5px":"top:2px;right:2px;bottom:7px;width:5px;");this.wrapper.appendChild(this.bar);c.appendChild(this.wrapper)}b.prototype={x:0,y:0,enabled:!0,handleEvent:function(a){switch(a.type){case D:this.touchStart(a);break;case r:this.touchMove(a);break;case w:this.touchEnd(a);break;case "webkitTransitionEnd":this.transitionEnd();break;case "orientationchange":case "resize":this.refresh();break;case "DOMSubtreeModified":this.onDOMModified(a)}},onDOMModified:function(a){var c=
this;a.target.parentNode==c.element&&(setTimeout(function(){c.refresh()},0),c.options.topOnDOMChanges&&(c.x!=0||c.y!=0)&&c.scrollTo(0,0,"0"))},refresh:function(){var a=this.x,c=this.y;this.scrollWidth=this.wrapper.clientWidth;this.scrollHeight=this.wrapper.clientHeight;this.scrollerWidth=this.element.offsetWidth;this.scrollerHeight=this.element.offsetHeight;this.maxScrollX=this.scrollWidth-this.scrollerWidth;this.maxScrollY=this.scrollHeight-this.scrollerHeight;this.directionY=this.directionX=0;if(this.scrollX)if(this.maxScrollX>=
0)a=0;else if(this.x<this.maxScrollX)a=this.maxScrollX;if(this.scrollY)if(this.maxScrollY>=0)c=0;else if(this.y<this.maxScrollY)c=this.maxScrollY;if(this.options.snap)this.maxPageX=-Math.floor(this.maxScrollX/this.scrollWidth),this.maxPageY=-Math.floor(this.maxScrollY/this.scrollHeight),c=this.snap(a,c),a=c.x,c=c.y;if(a!=this.x||c!=this.y)this.setTransitionTime("0"),this.setPosition(a,c,!0);this.scrollX=this.scrollerWidth>this.scrollWidth;this.scrollY=!this.options.bounceLock&&!this.scrollX||this.scrollerHeight>
this.scrollHeight;if(this.options.hScrollbar&&this.scrollX)this.scrollBarX=this.scrollBarX||new n("horizontal",this.wrapper,this.options.fadeScrollbar,this.options.shrinkScrollbar,this.options.scrollbarColor),this.scrollBarX.init(this.scrollWidth,this.scrollerWidth);else if(this.scrollBarX)this.scrollBarX=this.scrollBarX.remove();if(this.options.vScrollbar&&this.scrollY&&this.scrollerHeight>this.scrollHeight)this.scrollBarY=this.scrollBarY||new n("vertical",this.wrapper,this.options.fadeScrollbar,
this.options.shrinkScrollbar,this.options.scrollbarColor),this.scrollBarY.init(this.scrollHeight,this.scrollerHeight);else if(this.scrollBarY)this.scrollBarY=this.scrollBarY.remove()},setPosition:function(a,c,d){this.x=a;this.y=c;this.element.style.webkitTransform=m+this.x+"px,"+this.y+"px"+t;d||(this.scrollBarX&&this.scrollBarX.setPosition(this.x),this.scrollBarY&&this.scrollBarY.setPosition(this.y))},setTransitionTime:function(a){a=a||"0";this.element.style.webkitTransitionDuration=a;if(this.scrollBarX)this.scrollBarX.bar.style.webkitTransitionDuration=
a,this.scrollBarX.wrapper.style.webkitTransitionDuration=k&&this.options.fadeScrollbar?"300ms":"0";if(this.scrollBarY)this.scrollBarY.bar.style.webkitTransitionDuration=a,this.scrollBarY.wrapper.style.webkitTransitionDuration=k&&this.options.fadeScrollbar?"300ms":"0"},touchStart:function(a){var c;if(this.enabled){a.preventDefault();a.stopPropagation();this.scrolling=!0;this.moved=!1;this.distY=this.distX=0;this.setTransitionTime("0");if(this.options.momentum||this.options.snap)if(c=new WebKitCSSMatrix(window.getComputedStyle(this.element).webkitTransform),
c.e!=this.x||c.f!=this.y)document.removeEventListener("webkitTransitionEnd",this,!1),this.setPosition(c.e,c.f),this.moved=!0;this.touchStartX=e?a.changedTouches[0].pageX:a.pageX;this.scrollStartX=this.x;this.touchStartY=e?a.changedTouches[0].pageY:a.pageY;this.scrollStartY=this.y;this.scrollStartTime=a.timeStamp;this.directionY=this.directionX=0}},touchMove:function(a){if(this.scrolling){var c=e?a.changedTouches[0].pageX:a.pageX,d=e?a.changedTouches[0].pageY:a.pageY,f=this.scrollX?c-this.touchStartX:
0,b=this.scrollY?d-this.touchStartY:0,h=this.x+f,k=this.y+b;a.stopPropagation();this.touchStartX=c;this.touchStartY=d;if(h>=0||h<this.maxScrollX)h=this.options.bounce?Math.round(this.x+f/3):h>=0||this.maxScrollX>=0?0:this.maxScrollX;if(k>=0||k<this.maxScrollY)k=this.options.bounce?Math.round(this.y+b/3):k>=0||this.maxScrollY>=0?0:this.maxScrollY;if(this.distX+this.distY>5){if(this.distX-3>this.distY)k=this.y,b=0;else if(this.distY-3>this.distX)h=this.x,f=0;this.setPosition(h,k);this.moved=!0;this.directionX=
f>0?-1:1;this.directionY=b>0?-1:1}else this.distX+=Math.abs(f),this.distY+=Math.abs(b)}},touchEnd:function(a){if(this.scrolling){var c=a.timeStamp-this.scrollStartTime,d=e?a.changedTouches[0]:a,f,b;f=0;b=this.x;var h=this.y;this.scrolling=!1;if(this.moved)if(!this.options.snap&&c>250)this.resetPosition();else{this.options.momentum&&(a=this.scrollX===!0?this.momentum(this.x-this.scrollStartX,c,this.options.bounce?-this.x+this.scrollWidth/5:-this.x,this.options.bounce?this.x+this.scrollerWidth-this.scrollWidth+
this.scrollWidth/5:this.x+this.scrollerWidth-this.scrollWidth):{dist:0,time:0},d=this.scrollY===!0?this.momentum(this.y-this.scrollStartY,c,this.options.bounce?-this.y+this.scrollHeight/5:-this.y,this.options.bounce?(this.maxScrollY<0?this.y+this.scrollerHeight-this.scrollHeight:0)+this.scrollHeight/5:this.y+this.scrollerHeight-this.scrollHeight):{dist:0,time:0},f=Math.max(Math.max(a.time,d.time),1),b=this.x+a.dist,h=this.y+d.dist);if(this.options.snap)a=this.snap(b,h),b=a.x,h=a.y,f=Math.max(a.time,
f);this.scrollTo(b,h,f+"ms")}else if(this.resetPosition(),e){for(f=d.target;f.nodeType!=1;)f=f.parentNode;b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,a.view,1,d.screenX,d.screenY,d.clientX,d.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null);b._fake=!0;f.dispatchEvent(b)}}},transitionEnd:function(){document.removeEventListener("webkitTransitionEnd",this,!1);this.resetPosition()},resetPosition:function(){var a=this.x,c=this.y;if(this.x>=0)a=0;else if(this.x<this.maxScrollX)a=
this.maxScrollX;if(this.y>=0||this.maxScrollY>0)c=0;else if(this.y<this.maxScrollY)c=this.maxScrollY;if(a!=this.x||c!=this.y)this.scrollTo(a,c);else{if(this.moved)this.onScrollEnd(),this.moved=!1;this.scrollBarX&&this.scrollBarX.hide();this.scrollBarY&&this.scrollBarY.hide()}},snap:function(a,c){a=this.directionX>0?Math.floor(a/this.scrollWidth):this.directionX<0?Math.ceil(a/this.scrollWidth):Math.round(a/this.scrollWidth);this.pageX=-a;a*=this.scrollWidth;if(a>0)a=this.pageX=0;else if(a<this.maxScrollX)this.pageX=
this.maxPageX,a=this.maxScrollX;c=this.directionY>0?Math.floor(c/this.scrollHeight):this.directionY<0?Math.ceil(c/this.scrollHeight):Math.round(c/this.scrollHeight);this.pageY=-c;c*=this.scrollHeight;if(c>0)c=this.pageY=0;else if(c<this.maxScrollY)this.pageY=this.maxPageY,c=this.maxScrollY;return{x:a,y:c,time:Math.round(Math.max(Math.abs(this.x-a)/this.scrollWidth*500,Math.abs(this.y-c)/this.scrollHeight*500))}},scrollTo:function(a,c,d){this.x==a&&this.y==c?this.resetPosition():(this.moved=!0,this.setTransitionTime(d||
"350ms"),this.setPosition(a,c),d==="0"||d=="0s"||d=="0ms"?this.resetPosition():document.addEventListener("webkitTransitionEnd",this,!1))},scrollToPage:function(a,c,d){if(!this.options.snap)this.pageX=-Math.round(this.x/this.scrollWidth),this.pageY=-Math.round(this.y/this.scrollHeight);a=="next"?a=++this.pageX:a=="prev"&&(a=--this.pageX);c=="next"?c=++this.pageY:c=="prev"&&(c=--this.pageY);a=-a*this.scrollWidth;c=-c*this.scrollHeight;c=this.snap(a,c);a=c.x;c=c.y;this.scrollTo(a,c,d||"500ms")},scrollToElement:function(a,
c){if(a=typeof a=="object"?a:this.element.querySelector(a)){var d=this.scrollX?-a.offsetLeft:0,f=this.scrollY?-a.offsetTop:0;if(d>=0)d=0;else if(d<this.maxScrollX)d=this.maxScrollX;if(f>=0)f=0;else if(f<this.maxScrollY)f=this.maxScrollY;this.scrollTo(d,f,c)}},momentum:function(a,c,d,f){c=Math.abs(a)/c*1E3;var b=c*c/2.5/1E3,h=0;a>0&&b>d?(c=c*d/b/2.5,b=d):a<0&&b>f&&(c=c*f/b/2.5,b=f);b*=a<0?-1:1;return{dist:Math.round(b),time:Math.round(c/1.2)}},destroy:function(a){window.removeEventListener("onorientationchange"in
window?"orientationchange":"resize",this,!1);this.element.removeEventListener(D,this,!1);this.element.removeEventListener(r,this,!1);this.element.removeEventListener(w,this,!1);document.removeEventListener("webkitTransitionEnd",this,!1);this.options.checkDOMChanges&&this.element.removeEventListener("DOMSubtreeModified",this,!1);if(this.scrollBarX)this.scrollBarX=this.scrollBarX.remove();if(this.scrollBarY)this.scrollBarY=this.scrollBarY.remove();a&&this.wrapper.parentNode.removeChild(this.wrapper);
return null}};n.prototype={init:function(a,c){var d=document,b=Math.PI;if(this.dir=="horizontal"){if(this.maxSize!=this.wrapper.offsetWidth)this.maxSize=this.wrapper.offsetWidth,d=d.getCSSCanvasContext("2d","scrollbar"+this.uid+this.dir,this.maxSize,5),d.fillStyle="rgb(0,0,0)",d.beginPath(),d.arc(2.5,2.5,2.5,b/2,-b/2,!1),d.lineTo(this.maxSize-2.5,0),d.arc(this.maxSize-2.5,2.5,2.5,-b/2,b/2,!1),d.closePath(),d.fill()}else if(this.maxSize!=this.wrapper.offsetHeight)this.maxSize=this.wrapper.offsetHeight,
d=d.getCSSCanvasContext("2d","scrollbar"+this.uid+this.dir,5,this.maxSize),d.fillStyle="rgb(0,0,0)",d.beginPath(),d.arc(2.5,2.5,2.5,b,0,!1),d.lineTo(5,this.maxSize-2.5),d.arc(2.5,this.maxSize-2.5,2.5,0,b,!1),d.closePath(),d.fill();this.size=Math.max(Math.round(this.maxSize*this.maxSize/c),6);this.maxScroll=this.maxSize-this.size;this.toWrapperProp=this.maxScroll/(a-c);this.bar.style[this.dir=="horizontal"?"width":"height"]=this.size+"px"},setPosition:function(a){this.wrapper.style.opacity!="1"&&this.show();
a=Math.round(this.toWrapperProp*a);a<0?(a=this.shrink?a+a*3:0,this.size+a<7&&(a=-this.size+6)):a>this.maxScroll&&(a=this.shrink?a+(a-this.maxScroll)*3:this.maxScroll,this.size+this.maxScroll-a<7&&(a=this.size+this.maxScroll-6));a=this.dir=="horizontal"?m+a+"px,0"+t:m+"0,"+a+"px"+t;this.bar.style.webkitTransform=a},show:function(){if(k)this.wrapper.style.webkitTransitionDelay="0";this.wrapper.style.opacity="1"},hide:function(){if(k)this.wrapper.style.webkitTransitionDelay="350ms";this.wrapper.style.opacity=
"0"},remove:function(){this.wrapper.parentNode.removeChild(this.wrapper);return null}};var k="WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix,h=/iphone|ipad/gi.test(navigator.appVersion),e="ontouchstart"in window,D=e?"touchstart":"mousedown",r=e?"touchmove":"mousemove",w=e?"touchend":"mouseup",m="translate"+(k?"3d(":"("),t=k?",0)":")",d=0;window.iScroll=b})();namespace.lookup("com.pageforest.move-controller").defineOnce(function(b){function n(b,e){this.ui=b;this.history=e}var k=namespace.lookup("org.startpad.base");n.methods({merge:function(b,e){var n=this,r,w,m=0;w=Math.min(this.history.list.length,b.list.length);if(this.history.pos<w)w=this.history.pos;for(r=0;r<w;r++)if(k.isEqual(this.history.list[r],b.list[r]))m=r+1;else break;console.log("longestPrefix: "+m+" this.history.pos: "+this.history.pos+" this.history.list.length: "+this.history.list.length+
" newHistory.pos: "+b.pos+" newHistory.list.length: "+b.list.length);this.ui.setMovePos(m,!0,function(){n.ui.appendMoves(b);n.ui.setMovePos(b.pos,!0,e)})}});b.extend({MoveController:n})});namespace.lookup("com.pageforest.pawnpwn").defineOnce(function(b){function n(d){var a,c;d===0&&(a=8,c=0);d===1&&(a=0,c=8);return{i:4,j:a,walls:10,score:8,goalRow:c}}function k(d){var a,c,b=!1;d.length===4?(d.charCodeAt(0)===r?b="v":d.charCodeAt(0)===w&&(b="h"),a=d.charCodeAt(2)-m,c=d.charCodeAt(3)-t):d.length===2&&(a=d.charCodeAt(0)-m,c=d.charCodeAt(1)-t);return{i:a,j:c,wall:b}}function h(d){var a="";d.wall&&(a=d.wall+"-");a+=String.fromCharCode(d.i+m,d.j+t);return a}function e(){this.rg=[];this.iOut=
this.iIn=0}function D(){this.walls={};this.players=[];this.history={pos:0,list:[]};this.memo={};this.track=[[1,0],[-1,0],[0,-1]]}namespace.lookup("com.pageforest.client");var r=118,w=104,m=97,t=49;e.methods({push:function(d){this.rg[this.iIn++]=d},pop:function(){if(this.iIn===this.iOut)return null;return this.rg[this.iOut++]},fEmpty:function(){return this.iIn===this.iOut}});D.methods({init:function(){this.vWalls=[];this.hWalls=[];var d,a;for(d=0;d<9;d++){this.vWalls[d]=[];this.hWalls[d]=[];for(a=
0;a<9;a++)this.vWalls[d][a]=!1,this.hWalls[d][a]=!1}this.players[0]=n(0);this.players[1]=n(1);this.history={pos:0,list:[]};this.buildTrack()},getState:function(){return{players:this.players,walls:this.walls,history:this.history}},setState:function(d){this.players=d.players;this.walls=d.walls;this.history=d.history},move:function(d,a,c){var b=this.history.pos%2,f;if(a)if(a[0]==="w"){if(b!==parseInt(a[1],10))throw Error("wall chosen from wrong side");for(f=0;f<this.history.pos;f++)if(this.history.list[f].from===
a)throw Error("wall already claimed");}else{if(f=k(a),b=this.players[b],b.i!==f.i||b.j!==f.j)throw Error("move given a 'from' that is not the previous position");}else throw Error("no 'from' var in qg.move call");f=k(d);if(!c&&!this.isValidMove(d))return!1;if(!c&&!this.historyCurrent())this.history.list=this.history.list.slice(0,this.history.pos);c=this.history.pos%2;f.wall?(this.walls[d]=!0,this.players[c].walls--,this.memo={}):(this.players[c].i=f.i,this.players[c].j=f.j);c=this.breadthFirstSearch();
for(f=0;f<2;f++)this.players[f].score=c[f];this.history.list[this.history.pos]={move:d,score:this.getScore(),from:a};this.history.pos++;this.buildTrack();return!0},buildTrack:function(){var d,a,c,b=this.history.pos%2;a=(this.history.pos+1)%2;c=this.players[b].i;b=this.players[b].j;d=this.players[a].i;var f=this.players[a].j;a=this.getReachableMoves(h({i:c,j:b,walls:!1}));d=a.indexOf(h({i:d,j:f,wall:!1}));d!==-1&&(a=a.concat(this.getReachableMoves(a[d])),delete a[d],delete a[a.indexOf(h({i:c,j:b,wall:!1}))]);
this.track=[];b=[];d=[];var e=this.players[this.history.pos%2];for(c=0;c<a.length;c++)a[c]!==void 0&&(f=k(a[c]),b[b.length]=[f.i-e.i,f.j-e.j],d[d.length]=Math.atan2(-b[b.length-1][1],b[b.length-1][0])-Math.PI/2,d[d.length-1]>=0&&(d[d.length-1]-=Math.PI*2));var m;for(a=0;a<d.length;a++){f=-99;for(c=0;c<d.length;c++)d[c]>f&&(f=d[c],m=c);d[m]=-100;this.track[a]=b[m]}},isValidMove:function(d){if(this.memo[d])return!0;if(this.memo[d]===!1)return!1;var a=k(d),c=["v","h"],b=[],f=[];b[0]=[0,0,0];f[0]=[1,
-1,0];b[1]=[1,-1,0];f[1]=[0,0,0];var e=this.history.pos%2,m=(this.history.pos+1)%2,n=this.players[e].i,z=this.players[e].j,r=this.players[m].i;m=this.players[m].j;if(a.wall===!1){a=this.getReachableMoves(h({i:n,j:z,walls:!1}));c=a.indexOf(h({i:r,j:m,wall:!1}));c!==-1&&(a=a.concat(this.getReachableMoves(a[c])),delete a[c],delete a[a.indexOf(h({i:n,j:z,wall:!1}))]);if(a.indexOf(d)!==-1)return!0;return!1}if(this.players[e].walls===0)return!1;for(n=0;n<2;n++)if(a.wall===c[n]){if(this.walls[h({i:a.i,j:a.j,
wall:c[(n+1)%2]})])return this.memo[d]=!1;for(z=0;z<3;z++)if(this.walls[h({i:a.i+b[n][z],j:a.j+f[n][z],wall:c[n]})])return this.memo[d]=!1;this.walls[d]=!0;return this.breadthFirstSearch()!==!1?(delete this.walls[d],this.memo[d]=!0):(delete this.walls[d],this.memo[d]=!1)}},getReachableMoves:function(d,a){var c=k(d),b=["h","v","h","v"],f=[[-1,0],[0,0],[-1,0],[-1,-1]],e=[[-1,-1],[-1,0],[0,0],[-1,0]],m=[0,1,0,-1],n=[-1,0,1,0],r,t,w=[],y;for(y=0;y<4;y++)r=c.i+m[y],t=c.j+n[y],r>8||r<0||t>8||t<0||!this.walls[h({i:c.i+
f[y][0],j:c.j+e[y][0],wall:b[y]})]&&!this.walls[h({i:c.i+f[y][1],j:c.j+e[y][1],wall:b[y]})]&&(w[w.length]=a==void 0?h({i:r,j:t,wall:!1}):y);return w},breadthFirstSearch:function(){var d,a,c,b,f,k,m=[100,100];for(a=0;a<2;a++){k={};d=h({i:this.players[a].i,j:this.players[a].j,wall:!1});c=new e;c.push([d,0]);for(k[d]=0;!c.fEmpty();){d=c.pop();f=this.getReachableMoves(d[0]);b=d[1];for(d=0;d<f.length;d++)k[f[d]]||k[f[d]]===0||(c.push([f[d],b+1]),k[f[d]]=b+1)}for(d=0;d<9;d++)c=h({i:d,j:this.players[a].goalRow,
wall:!1}),k[c]>=0&&k[c]<m[a]&&(m[a]=k[c])}if(m[0]==100||m[1]==100)return!1;return m},changeHistoryPos:function(d){var a,c,b;if(d===this.history.pos)return!1;if(d<this.history.pos){a=this.history.pos-d;for(c=0;c<a;c++)this.unMove()}if(d>this.history.pos){a=d-this.history.pos;for(c=0;c<a;c++)d=this.history.list[this.history.pos].move,b=this.history.list[this.history.pos].from,this.move(d,b,!0)}this.buildTrack();return this.history},unMove:function(){this.history.pos--;var d=this.history.list[this.history.pos],
a=k(d.move);d=k(d.from);var c=this.history.pos%2;a.wall?(delete this.walls[h(a)],this.players[c].walls++):(this.players[c].i=d.i,this.players[c].j=d.j,this.history.pos===0?(this.players[0].score=8,this.players[1].score=8):(this.players[0].score=this.history.list[this.history.pos-1].score[0],this.players[1].score=this.history.list[this.history.pos-1].score[1]))},historyCurrent:function(){return this.history.list.length===this.history.pos?!0:!1},getScore:function(){return[this.players[0].score,this.players[1].score]},
currentPlayer:function(){return this.history.pos%2},isGameOver:function(){var d=this.getScore();if(d[0]===0||d[1]===0)return!0;return!1}});b.extend({PawnPwnGame:D,encode:h,decode:k,newPlayer:n})});namespace.lookup("com.pageforest.pawnpwnUI").defineOnce(function(b){function n(){typeof applicationCache!="undefined"&&(applicationCache.status==applicationCache.UPDATEREADY?(applicationCache.swapCache(),location.reload()):applicationCache.addEventListener("updateready",n,!1))}function k(a,d,c,b,g){if(a>600&&d>700){if(d/(a-c)>s)return 5;if(a-d/s>c+g[0])return 2;return 1}if(d/a>s){if(d-b-a*s>120)return 4;return 3}a-=d/s;if(a<g[0])return 3;if(a>c+g[0])return 2;return 1}function h(){var a,d,c,b=[];a=
window.innerHeight;d=window.innerWidth;if(!(W[0]==d&&W[1]==a)){W=[d,a];var i,f=0;$("body").addClass("noAppBar");$("body").css("margin-top",0);d>525&&a>450&&(f=40,a-=35,$("body").removeClass("noAppBar"),$("body").css("margin-top","35px"));b=[];var h=[],v=[],m=[],n=[200,150];c=40;i=k(d,a,175,c,n);$("body").css("height",a);$("body").removeClass("five");$("body").removeClass("four");$("body").removeClass("three");$("body").removeClass("two");$("body").removeClass("one");i==5&&($("body").addClass("five"),
h=[d-10-5-175-5,a],v[0]=h[0],a-h[0]*s<n[1]+10?(h[1]=a-n[1]-10,b=[h[1]/s,h[1]],v=[h[0],n[1]]):(h[1]=h[0]*s,b=h,v[1]=a-h[1]-10),j.setPos(g.gradientv,[h[0],-f]),j.setPos(g.gradienth,[0,h[1]]),j.setPos(g.gradientCorner,[h[0],h[1]]),m=[175,a-c-5-30-5-30-5],j.setPos(g.board,[h[0]/2-b[0]/2,0]),j.setPos(g.graph,[5,h[1]+10+5]),j.setPos(g.title,[h[0]+10+5,0]),j.setPos(g.aboutsi,[h[0]+10+5,c]),j.setPos(g.movelist,[h[0]+10+5,c+5+30]),j.setPos(g.buttons,[h[0]+10+5,c+5+30+5+m[1]]));i==4&&($("body").addClass("four"),
b=[d-2,(d-2)*s],v=[d,a-b[1]-32-5-30-10],j.setPos(g.board,[0,32]),j.setPos(g.title,[0,0]),j.setPos(g.aboutsi,[b[0]-175-5,5]),j.setPos(g.buttons,[b[0]/2-87.5,b[1]+32]),j.setPos(g.gradienth,[0,b[1]+32+30+5]),j.setPos(g.graph,[5,b[1]+32+5+30+10+5]));i==3&&($("body").addClass("three"),b=[d,a-32-30-5],j.setPos(g.board,[0,32]),j.setPos(g.title,[0,0]),j.setPos(g.aboutsi,[b[0]-175-5,5]),j.setPos(g.buttons,[b[0]/2-87.5,b[1]+32]));i==2&&(f==0&&(c=5),$("body").addClass("two"),b=[a/s,a],v=[d-b[1]/s-10-5-175-5,
a-3],m=[175,a-c-5-30-5-30-5],j.setPos(g.board,[0,0]),j.setPos(g.gradientv,[b[1]/s,-f]),j.setPos(g.graph,[b[1]/s+15,8]),j.setPos(g.title,[b[1]/s+15+v[0],0]),j.setPos(g.aboutsi,[b[1]/s+15+v[0],c]),j.setPos(g.movelist,[b[1]/s+15+v[0],c+5+30]),j.setPos(g.buttons,[b[1]/s+15+v[0],c+5+30+5+m[1]]));i==1&&($("body").addClass("one"),f==0&&(c=5),b=[a/s,a],v=[d-b[0]-10,a-c-5-30-5-30-5],j.setPos(g.board,[0,0]),j.setPos(g.gradientv,[b[0],-f]),j.setPos(g.graph,[b[0]+10+5,5+c+5+30+5]),j.setPos(g.title,[b[0]+10+5+
v[0]/2-87.5,0]),j.setPos(g.aboutsi,[b[0]+10+5+v[0]-175-5-5,c]),j.setPos(g.movelist,[b[0]+10+5+v[0],c+5+30]),j.setPos(g.buttons,[b[0]+10+v[0]/2-87.5,c+5+30+5+v[1]]));j.setSize(g.gradientv,[10,a+f]);i==5?j.setSize(g.gradienth,[h[0],10]):j.setSize(g.gradienth,[d,10]);j.setSize(g.board,b);j.setSize(g.graph,v);a=l.sub(v,[10,10]);g.historyGraph.width=a[0];g.historyGraph.height=a[1];j.setSize(g.movelist,m);j.setSize(g.tableDiv,m);T=new na.GraphLines(g.historyGraph);O();i!==3||b[1]/b[0]<s?(j.setPos(g.divBoard,
[b[0]/2-b[1]/2+5,5]),e(b[1]-10,f)):(j.setPos(g.divBoard,[b[0]/2-(b[0]*s-10)/2,5]),e(b[0]*s-10,f))}}function e(a,b){var o=a/575,f;E=[parseFloat(g.divBoard.style.left)+parseFloat(g.board.style.left),parseFloat(g.divBoard.style.top)+parseFloat(g.board.style.top)];b&&(E[1]+=b);p[1]=90.1*o;p[0]=90.3*o;p=[p[0],p[1]];J=11*o;K=81*o;q=35*o;U=l.mult(0.5,[q,q]);u=10*o;F=80*o;N=[F-0.5*q,0.5*u];L=[0.5*u,F-0.5*q];M=9*q+8*u;for(f=0;f<2;f++)X[(f+1)%2]=[0,f*(p[1]+M+u),a,f*(p[1]+M+u)+F];x=[u+q,u+q];Y=35*o;P=10*o;Q=
18*o;ba=[-P,Q,P,-Q];ca=[Q,-P,-Q,P];da=Math.pow(o,2)*800/15;ea=Math.pow(o,2)*4E3/15;Z=0.5*o;var h,e;z();$(g.imgBoard).css("width",a);$(g.imgBoard).css("height",a);V();var k;f=!1;for(o=0;o<2;o++){for(h=0;h<10;h++){e="w"+o+"_"+h;for(k=0;k<pp.history.pos;k++)if(pp.history.list[k].from==e){f=k;break}f!==!1?(i.wallHome=e,d(pp.history.list[f].move,!1),pp.history.list[f].move[0]=="v"?j.setSize(g[e],[J,K]):j.setSize(g[e],[K,J]),f=!1):(j.setPos(g[e],H[e]),j.setSize(g[e],[J,K]))}j.setSize(g["p"+o+"pic"],[Y,
Y]);h=A.encode({i:pp.players[o].i,j:pp.players[o].j,wall:!1});i.pColor=o;t(h,!1)}c();o=p[0]-u;j.setPos(g.yourmove1,[o,p[1]-F-u+3]);j.setPos(g.yourmove0,[o,p[1]+M+u]);fa()}function D(a){a=l.sub(a,E);l.subFrom(a,p);var d,c=[];for(d=0;d<2;d++)c[d]=a[d]%x[d];return{i:Math.round((a[0]-c[0])/x[0]),j:Math.round((a[1]-c[1])/x[1]),k:c[1]>q?c[0]>q?3:1:c[0]>q?2:0}}function r(a){function d(a){var c=[a.i*x[0],a.j*x[1]];l.addTo(c,E,p);var b=[];a.wall=="v"&&(c[0]+=q,b[0]=c[0]+u,b[1]=c[1]+F);a.wall=="h"&&(c[1]+=
q,b[0]=c[0]+F,b[1]=c[1]+u);return c.concat(b)}var c=D(a),b=[],f,g,h,e,k=[["h",-1,-1],["h",0,-1],["h",1,-1],["h",-1,0],["h",0,0],["h",1,0],["v",-1,-1],["v",-1,0],["v",-1,1],["v",0,-1],["v",0,0],["v",0,1]];for(e=0;e<k.length;e++)g=c.i+k[e][1],h=c.j+k[e][2],f=k[e][0],g>=0&&g<=7&&h>=0&&h<=7&&(b[b.length]={i:g,j:h,wall:f});c=[a[0]-L[0],a[1]-L[1],a[0]+L[0],a[1]+F-L[1]];l.addTo(c,ba);g=[a[0]-N[0],a[1]-N[1],a[0]+F-N[0],a[1]+N[1]];l.addTo(g,ca);a=[];for(e=0;e<b.length;e++)f=d(b[e]),a[e]=b[e].wall=="v"?l.area(l.rcClipToRect(c,
f)):l.area(l.rcClipToRect(g,f)),b[e].wall==i.orient&&(a[e]+=da);var j;for(e=f=0;e<b.length;e++)a[e]>f&&a[e]>ea&&pp.isValidMove(A.encode(b[e]))&&(j=e,f=a[e]);if(j===void 0)return!1;return A.encode(b[j])}function w(a){a=l.sub(a,E);var c;if(pp.currentPlayer()===0&&l.ptInRect(a,X[0]))c=0;else if(pp.currentPlayer()===1&&l.ptInRect(a,X[1]))c=1;else return!1;a=Math.floor((a[0]-(p[0]-u-U[0]))/x[0]);var b="w"+c+"_"+a;for(c=0;c<pp.history.pos;c++)if(pp.history.list[c].from==b||a<0||a>9)return!1;return b}function m(a,
c,b){a!=c&&(c=="h"?j.setSize(g[i.wallHome],[K,J]):c=="v"&&j.setSize(g[i.wallHome],[J,K]),a=c);b!==void 0&&(b=a=="h"?l.sub(b,N):l.sub(b,L),l.subFrom(b,E),j.setPos(g[i.wallHome],b))}function t(a,c){var b=A.decode(a);b=l.mult([b.i,b.j],x);b=l.add(b,p);c?$(g["p"+i.pColor]).animate({left:b[0],top:b[1]},100):j.setPos(g["p"+i.pColor],b)}function d(a,c){var b=A.decode(a),d=l.mult([b.i,b.j],x);d=l.add(d,p);b.wall=="v"&&(d[0]+=q);b.wall=="h"&&(d[1]+=q);c?$(g[i.wallHome]).animate({left:d[0],top:d[1]},R):j.setPos(g[i.wallHome],
d)}function a(){if(i.valid){var a=l.sub(I,i.pos),c=Math.sqrt(l.magnitude2(a));if(i.pColor===!1)ga=c/M*100,l.addTo(i.pos,l.mult(a,0.35)),i.wall=r(i.pos),i.wall===!1?i.pos[1]<3.5*q||i.pos[1]>M+3.5*q?(m(i.orient,"v",i.pos),i.orient="v"):m(i.orient,i.orient,i.pos):(m(i.orient,i.wall[0],i.pos),i.orient=i.wall[0]);else{var b=i,d;d=D(I);d.k!==0?d=!1:(d=A.encode({i:d.i,j:d.j,wall:!1}),d=pp.isValidMove(d)?d:!1);b.pMove=d;c<=Z*aa?i.pos=l.copy(I):l.addTo(i.pos,l.mult(a,Z*aa/c));j.setPos(g["p"+i.pColor],l.sub(l.sub(i.pos,
U),E))}}}function c(){i={valid:!1,wall:!1,wallHome:!1,orient:"v",pMove:!1,pColor:!1,pos:[0,0],offset:[]}}function S(a){a.preventDefault();if(i.valid){var c=!1;a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches.length&&(a=a.originalEvent.touches[0],c=!0);posMouse=[a.pageX,a.pageY];if(i.pColor===!1)I=posMouse,c&&l.subFrom(I,[0,60]);else{l.subFrom(posMouse,i.offset);a=pp.players[pp.currentPlayer()];a=f(a.i,a.j);var b=l.sub(posMouse,a);c=b[0];b=b[1];var d=x[0],e,g=10,h,k=Math.atan2(-b,
c)-Math.PI/2;k>=0&&(k-=Math.PI*2);var j;for(j=0;j<pp.track.length;j++)h=Math.atan2(-pp.track[j][1],pp.track[j][0])-Math.PI/2,h>=0&&(h-=Math.PI*2),h=Math.abs(k-h),h>Math.PI&&(h=Math.PI*2-h),h<g&&(g=h,e=j);e=l.copy(pp.track[e]);e=l.mult(e,d);d=l.magnitude2(e);c=l.dotProduct(e,[c,b])/d;c<0&&(c=0);c<1&&(e=l.mult(e,c));I=l.add(e,a)}}}function f(a,c){return l.add(E,p,l.mult([a,c],x),U)}function ka(a){if(B)console.log("onMouseDown called when freezeUI == true");else if(!(a.which&&a.which>1)){a.preventDefault();
a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches.length&&(a=a.originalEvent.touches[0]);var c=[a.pageX,a.pageY],b;B===!0?b=!1:(b=pp.players[pp.currentPlayer()],pos=f(b.i,b.j),Math.sqrt(l.distance2(c,pos))<1.5*q?(i.offset=l.sub(c,pos),b=!0):b=!1);if(G=b?"p"+pp.currentPlayer():w(c))if(G[2]=="_")I=[a.pageX,a.pageY],i.pos=l.add(H[G],L,E),i.valid=!0,i.wallHome=G,i.orient="v",G=!1,$("#"+i.wallHome).addClass("grabbing");else if(G[0]==="p"&&parseInt(G[1],10)===pp.currentPlayer())I=l.sub([a.pageX,
a.pageY],i.offset),a=pp.players[pp.currentPlayer()],i.pos=f(a.i,a.j),i.valid=!0,i.pColor=parseInt(G[1],10),G=!1,$("#p"+i.pColor).addClass("grabbing")}}function O(){var a,c='<tr><th scope="maincol"></th><th scope="col">White</th><th scope="col">Black</th></tr>',b;for(b=0;b<pp.history.list.length;b++)a=pp.history.list[b].move,c+=b<pp.history.pos?b%2===0?'<tr><th scope="row">'+(b/2+1)+". </th><td>"+a+"</td>":"<td>"+a+"</td></tr>":b%2===0?'<tr><th scope="past">'+(b/2+1)+'.</th><td scope="past">'+a+"</td>":
'<td scope="past">'+a+"</td></tr>";$(g.historyTable).html(c);$(g.moveNum).html("Move "+(Math.floor(pp.history.pos/2)+1));ha.refresh();c=[[[0,8]],[[0,8]]];var d=pp.history.pos,e=pp.history.list;for(b=0;b<2;b++)for(a=0;a<pp.history.list.length;a++)c[b][a+1]=[a+1,e[a].score[b]];T.draw(c,!0);c=[[[0,8]],[[0,8]]];for(b=0;b<2;b++)for(a=0;a<d;a++)c[b][a+1]=[a+1,e[a].score[b]];T.draw(c);if(!pp.historyCurrent()){c=d>0?[[],[]]:[[[0,8]],[[0,8]]];for(b=0;b<2;b++){d!==0&&(c[b][0]=[d,e[d-1].score[b]]);for(a=1;a<
e.length-d+1;a++)c[b][a]=[d+a,e[d+a-1].score[b]]}T.draw(c,!1,!1,"butt",1)}}function V(){if(i.valid){var a=!1;if(i.wallHome){$("#"+i.wallHome).removeClass("grabbing");if(i.wall&&ga<oa)d(i.wall,!0),pp.move(i.wall,i.wallHome,!1),a=!0;else{i.orient=="h"&&($("#"+i.wallHome).css("width",J),$("#"+i.wallHome).css("height",K),$("#"+i.wallHome).attr("src","images/wall.png"));var e=H[i.wallHome];$("#"+i.wallHome).animate({left:e[0],top:e[1]},500)}c()}i.pColor!==!1&&($("#p"+i.pColor).removeClass("grabbing"),
i.pMove?(a=pp.players[i.pColor],a=A.encode({i:a.i,j:a.j,wall:!1}),pp.move(i.pMove,a,!1),t(i.pMove,!0),a=!0):t(A.encode({i:pp.players[i.pColor].i,j:pp.players[i.pColor].j,wall:!1}),!0),e=pp.getScore(),B=pp.isGameOver(),e[0]===0?alert("White wins!"):e[1]===0&&alert("Black wins!"),c());a&&(O(),b.client.checkDoc(),b.client.username!=void 0&&(b.client.setDirty(),b.client.save()));c()}}function z(){var a,b;for(a=0;a<10;a++)b=p[0]-u+a*x[0],H["w0_"+a]=[b,p[1]+M+u],H["w1_"+a]=[b,3]}function la(){var a="";
$("#divBoard").html(a);var b,c,d;z();for(c=0;c<2;c++)for(b=0;b<10;b++)d=H["w"+c+"_"+b],a+="<img class='wall'id='w"+c+"_"+b+"' src='images/wall.png' alt='wall' style=' top:"+d[1]+"px; left:"+d[0]+"px;'></img>";b=p[1]+8*(q+u);c=p[1];d=p[0]+4*(q+u);a+="<img class='board' id='imgBoard' src='images/board.png'alt='board'></img>";a+="<div class=divPawn id=p0><img id=p0pic class=pawn src='images/white.png'alt='WhitePawn' style=' top:"+b+"px; left:"+d+"px;'></img><div id=yourmovep0 class=yourmovep></div></div>";
a+="<div class=divPawn id=p1><img id=p1pic class=pawn src='images/black.png'alt='BlackPawn' style=' top:"+c+"px; left:"+d+"px;'></img><div id=yourmovep1 class=yourmovep></div></div>";a+="<div id=yourmove1 class=yourmove></div><div id=yourmove0 class=yourmove></div>";$("#divBoard").html(a);g=j.bindIDs()}function ma(a){$(g["yourmove"+a]).animate({opacity:0},700);$(g["yourmovep"+a]).animate({opacity:0},700)}function y(){if(!B){var a=pp.history.pos%2;$(g["yourmove"+a]).animate({opacity:0.4},300,ma.fnArgs(a));
$(g["yourmovep"+a]).animate({opacity:0.4},300)}}function ia(a){console.log(a+" button clicked");if(B&&!pp.isGameOver())console.log(a+" button clicked, but UI is frozen");else if(a=="back"&&pp.history.pos===0||a=="fwd"&&pp.historyCurrent())console.log(a+" button clicked, but history is at limit");else{console.log("going "+a+" from "+pp.history.pos);var c;a=="back"&&(c=pp.history.pos-1);a=="fwd"&&(c=pp.history.pos+1);B=!0;C(c,!0,function(){B=!1;O();b.client.checkDoc();b.client.username!=void 0&&(b.client.setDirty(),
b.client.save())})}}function pa(){console.log("back button clicked");ia("back")}function qa(){console.log("fwd button clicked");ia("fwd")}function C(a,b,d){i.valid&&V();O();var e,f;if(a==pp.history.pos){if(d==void 0)throw Error("setMovePos called without an fnComplete function");d();c()}else if(a<pp.history.pos){pp.changeHistoryPos(pp.history.pos-1);f=pp.history.list[pp.history.pos];if(f.move.length===4)if(i.wallHome=f.from,e=H[i.wallHome],m("h","v"),b)$(g[i.wallHome]).animate({left:e[0],top:e[1]},
R,C.fnArgs(a,b,d));else{j.setPos(g[i.wallHome],[e[0],e[1]]);C(a,b,d);return}f.move.length===2&&(f=pp.players[pp.history.pos%2],f=l.add(p,l.mult([f.i,f.j],x)),b?$(g["p"+pp.history.pos%2]).animate({left:f[0],top:f[1]},R,C.fnArgs(a,b,d)):(j.setPos(g["p"+pp.history.pos%2],f),C(a,b,d)))}else{f=pp.history.list[pp.history.pos];e=A.decode(f.move);pp.changeHistoryPos(pp.history.pos+1);if(e.wall)if(i.wallHome=f.from,m("v",f.move[0]),f=l.add(p,l.mult([e.i,e.j],x)),e.wall=="v"&&(f[0]+=q),e.wall=="h"&&(f[1]+=
q),b)$(g[i.wallHome]).animate({left:f[0],top:f[1]},R,C.fnArgs(a,b,d));else{j.setPos(g[i.wallHome],f);C(a,b,d);return}e.wall===!1&&(e=(pp.history.pos-1)%2,f=pp.players[e],f=l.add(p,l.mult([f.i,f.j],x)),b?$(g["p"+e]).animate({left:f[0],top:f[1]},R,C.fnArgs(a,b,d)):(j.setPos(g["p"+e],f),C(a,b,d)))}}function ra(){b.client.username==void 0?b.client.signIn(b.client.username):window.open("http://pageforest.com/docs/")}function ja(a){a==void 0?$("#signIn").attr("src","images/signin30.png"):$("#signIn").attr("src",
"images/mydocs30.png")}function fa(){return{readers:["public"],writers:["public"],blob:{title:"Pawn Pwn Game",version:3,game:pp.getState()}}}var sa=namespace.lookup("com.pageforest.client"),A=namespace.lookup("com.pageforest.pawnpwn"),ta=namespace.lookup("com.pageforest.move-controller"),na=namespace.lookup("com.pageforest.graph"),l=namespace.lookup("org.startpad.vector"),j=namespace.lookup("org.startpad.dom"),W=[0,0],i={valid:!1,wall:!1,wallHome:!1,orient:"v",pMove:!1,pColor:!1,pos:[0,0],offset:[]},
G=!1,R=300,g,B=!1,T,E=[],p=[],U=[],x=[],N=[],L=[],X=[[],[]],q,u,M,F,J,K,Y,P,Q,ba,ca,da=100,ea=600,H={},Z=0.5,ga,oa=5,s=1.37,I=[0,0],aa=50,ha;b.extend({onReady:function(){addEventListener?(ha=new iScroll("scroller"),n(),pp=new A.PawnPwnGame,pp.init(),mc=new ta.MoveController(b,pp.history),la(),$(g.about).bind("click",function(){var a="/about.html/";location.hash&&(a+=location.hash);window.open(a)}),$("#divBoard").bind("mousemove touchmove",S),$(document).bind("mouseup touchend touchcancel",V),$("#divBoard").bind("mousedown touchstart",
ka),$("#back").bind("click",pa),$("#fwd").bind("click",qa),$(document).bind("touchmove",function(a){a.preventDefault()}),$(window).bind("resize",function(){setTimeout(function(){h()},0)}),setInterval(y,1E4),setInterval(a,aa),b.client=new sa.Client(b),b.client.addAppBar(),$("#pfAppBarBox").css("z-index","1002"),$("#pfAppPanel").css("z-index","1001"),$(".sign-in").click(ra),ja(b.client.username),b.client.poll(),h(),b.client.saveInterval=0,b.client.autoLoad=!0,$("body").css("background-color","#616161"),
$("h1").css("color","#ffffff"),$("#tableDiv").css("background-color","#9e9e9e")):($("body").addClass("fail"),$("body").html("You're using a really old browser!  Upgrade to <a href='http://www.mozilla.com/en-US/firefox/'>Mozilla Firefox</a>, <a href='http://www.google.com/chrome'>Google Chrome</a>, <a href='http://windows.microsoft.com/en-us/internet-explorer/products/ie/home'>Internet Explorer 9</a>.  Note that if you are using a version of Windows that is unable to use IE 9 (XP and below), you should use Chrome or Firefox because Pawn Pwn will not work on IE 8 and below."))},
getDoc:fa,setDoc:function(a){B?console.log("setDoc called when UI frozen"):(B=!0,mc.merge(a.blob.game.history,function(){B=!1;O()}));i.wallHome=""},setMovePos:C,appendMoves:function(a){pp.history.list=a.list},grabbing:i,wallHome:H,parts:g,onResize:h,onUserChange:ja})});